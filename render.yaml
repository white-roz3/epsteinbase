services:
  - type: web
    name: epsteinbase-api
    env: python3.11
    rootDir: backend
    buildCommand: |
      curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y --default-toolchain stable
      source $HOME/.cargo/env
      export CARGO_HOME="$HOME/.cargo"
      export RUSTUP_HOME="$HOME/.rustup"
      export PATH="$HOME/.cargo/bin:$PATH"
      python3.11 -m pip install --upgrade pip setuptools wheel
      python3.11 -m pip install -r requirements-api.txt
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PORT
        value: 10000
      - key: PYTHON_VERSION
        value: "3.11.9"
      # Database URL will be set automatically when you add PostgreSQL
      # B2 credentials - set these in Render dashboard
      # - key: B2_APPLICATION_KEY_ID
      #   sync: false
      # - key: B2_APPLICATION_KEY
      #   sync: false
      # - key: B2_BUCKET_NAME
      #   value: Epsteinbase

databases:
  - name: epsteinbase-db
    databaseName: epsteinbase
    user: epsteinbase
    plan: free  # Free for 90 days, then $7/month


